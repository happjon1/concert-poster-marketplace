<!-- Edit Mode -->
<form [formGroup]="profileForm" (ngSubmit)="onSaveProfile()">
  <h2 class="fs-5 fw-medium mb-4">Edit Profile</h2>

  <div class="mb-4">
    <div class="form-floating">
      <input
        type="text"
        id="name"
        class="form-control"
        formControlName="name"
        placeholder="Full name"
        [ngClass]="{
          'is-invalid':
            profileForm.get('name')?.invalid &&
            profileForm.get('name')?.touched,
        }" />
      <label for="name"> <i class="bi bi-person me-2"></i>Name </label>
      <div
        class="invalid-feedback"
        *ngIf="
          profileForm.get('name')?.invalid && profileForm.get('name')?.touched
        ">
        Name is required (min. 2 characters)
      </div>
    </div>
  </div>

  <div class="mb-4">
    <div class="form-floating">
      <input
        type="email"
        id="email"
        class="form-control"
        formControlName="email"
        placeholder="Email address"
        [ngClass]="{
          'is-invalid':
            profileForm.get('email')?.invalid &&
            profileForm.get('email')?.touched,
        }" />
      <label for="email"> <i class="bi bi-envelope me-2"></i>Email </label>
      <div
        class="invalid-feedback"
        *ngIf="
          profileForm.get('email')?.invalid && profileForm.get('email')?.touched
        ">
        Valid email is required
      </div>
    </div>
  </div>

  <div class="mb-4">
    <div class="form-floating">
      <textarea
        id="bio"
        class="form-control"
        formControlName="bio"
        placeholder="Tell us about yourself"
        style="height: 120px">
      </textarea>
      <label for="bio"> <i class="bi bi-card-text me-2"></i>Bio </label>
      <div class="form-text text-end">
        {{ profileForm.get('bio')?.value?.length || 0 }}/300
      </div>
    </div>
  </div>

  <div class="d-flex justify-content-end gap-3 mt-4">
    <button
      type="button"
      class="btn btn-outline-danger"
      (click)="onCancelEdit()"
      [disabled]="saving">
      Cancel
    </button>
    <button
      type="submit"
      class="btn btn-primary"
      [disabled]="profileForm.invalid || saving">
      @if (saving) {
        <span
          class="spinner-border spinner-border-sm me-2"
          role="status"></span>
        Saving...
      } @else {
        Save Changes
      }
    </button>
  </div>
</form>
